---
import Layout from '../layouts/Layout.astro';
import NavBar from '../components/NavBarCentered.astro';
const validWords = await Astro.glob('./words/*.txt');
const wordList = validWords.map(wordFile => wordFile.default as string);

function getRandomWord(words: string[]): string {
    const randomIndex = Math.floor(Math.random() * words.length);
    return words[randomIndex];
}

const randomWord = getRandomWord(wordList);
---

<Layout title="Wordle Game">
    <script>
        if (!localStorage.getItem('authenticated')) {
            window.location.href = '/'; // Redirect to password page if not authenticated
        }
    </script>
    <div class="bg-stone-100 w-100 min-h-screen p-10">
        <div class="min-h-screen bg-gray-100 p-4">
            <NavBar
                    link1name="Love"
                    link1 = "/home"
                    link2name="Fan"
                    link2 = "/fan"
                    link3name="Wordle"
                    link3 = "/wordle"
            />
            <div class="space-y-6 flex-col flex items-center text-center">
                <div id="wordle-game" class="prose prose-lg text-center mt-10">
                    <!-- Wordle game will be implemented here -->
                </div>
                <div id="streak-counter" class="prose prose-lg text-center mt-10">
                    <p>Current Streak: <span id="streak"></span></p>
                </div>
            </div>
        </div>
    </div>
    <script>
        const randomWord = "{{randomWord}}";
        let streak = parseInt(localStorage.getItem('wordleStreak') || '0', 10);

        document.getElementById('streak').innerText = streak.toString();

        function checkGuess(guess: string) {
            if (guess === randomWord) {
                streak++;
                localStorage.setItem('wordleStreak', streak.toString());
                alert('You guessed correctly!');
            } else {
                alert('Try again!');
            }
            const streakElement = document.getElementById('streak');
            if (streakElement) {
                streakElement.innerText = streak.toString();
            }
        }
    </script>
</Layout>
