---
import Layout from '../layouts/Layout.astro';
import NavBar from '../components/NavBarCentered.astro';
import { useState, useEffect } from 'react';

const validWords = await Astro.glob('./words/*.txt'); // Assuming you have a list of words in a txt file

// Function to pick a random word from the list
function getRandomWord(words: string[]): string {
    const randomIndex = Math.floor(Math.random() * words.length);
    return words[randomIndex];
}

const randomWord = getRandomWord(validWords);
---

<Layout title="Wordle Game">
    <script>
        if (!localStorage.getItem('authenticated')) {
            window.location.href = '/'; // Redirect to password page if not authenticated
        }
    </script>
    <div class="bg-stone-100 w-100 min-h-screen p-10">
        <div class="min-h-screen bg-gray-100 p-4">
            <NavBar
                    link1name="Love"
                    link1 = "/home"
                    link2name="Fan"
                    link2 = "/fan"
                    link3name="Wordle"
                    link3 = "/wordle"
            />
            <div class="space-y-6 flex-col flex items-center text-center">
                <div id="wordle-game" class="prose prose-lg text-center mt-10">
                    <!-- Wordle game will be implemented here -->
                </div>
                <div id="streak-counter" class="prose prose-lg text-center mt-10">
                    <p>Current Streak: <span id="streak"></span></p>
                </div>
            </div>
        </div>
    </div>
    <script>
        const randomWord = "{{randomWord}}";
        let streak = localStorage.getItem('wordleStreak') || 0;

        document.getElementById('streak').innerText = streak;

        // Implement simple Wordle game logic here
        // You can create input fields for guesses, compare them to the randomWord,
        // and update the streak in localStorage based on the outcome.
        function checkGuess(guess) {
            if (guess === randomWord) {
                streak++;
                localStorage.setItem('wordleStreak', streak);
                alert('You guessed correctly!');
            } else {
                alert('Try again!');
            }
            document.getElementById('streak').innerText = streak;
        }
    </script>
</Layout>
